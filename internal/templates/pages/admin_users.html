{{define "title"}}Admin: Users - asiakirjat{{end}}

{{define "content"}}
<div class="admin-page">
    <h1>Manage Users</h1>

    <div class="admin-nav">
        <a href="/admin/projects" class="admin-nav-link">Projects</a>
        <a href="/admin/users" class="admin-nav-link active">Users</a>
        <a href="/admin/robots" class="admin-nav-link">Robot Users</a>
        <a href="/admin/groups" class="admin-nav-link">Group Mappings</a>
    </div>

    <div class="admin-create-form">
        <h2>Create User</h2>
        <form method="POST" action="/admin/users">
            <div class="form-row">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email">
                </div>
                <div class="form-group">
                    <label for="role">Role</label>
                    <select id="role" name="role">
                        <option value="viewer">Viewer</option>
                        <option value="editor">Editor</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Create</button>
            </div>
        </form>
    </div>

    <table class="admin-table">
        <thead>
            <tr>
                <th>Username</th>
                <th>Email</th>
                <th>Role</th>
                <th>Auth Source</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {{range .Users}}
            <tr>
                <td>{{.Username}}</td>
                <td>{{.Email}}</td>
                <td>{{.Role}}</td>
                <td>{{.AuthSource}}</td>
                <td>{{.CreatedAt.Format "2006-01-02"}}</td>
                <td>
                    {{if eq .AuthSource "builtin"}}
                    <form method="POST" action="/admin/users/{{.ID}}/password" class="inline-form">
                        <input type="password" name="password" placeholder="New password" required>
                        <button type="submit" class="btn btn-small">Reset</button>
                    </form>
                    {{end}}
                    <form method="POST" action="/admin/users/{{.ID}}/delete" class="inline-form"
                        onsubmit="return confirm('Delete user {{.Username}}?')">
                        <button type="submit" class="btn btn-small btn-danger">Delete</button>
                    </form>
                </td>
            </tr>
            {{else}}
            <tr><td colspan="6">No users.</td></tr>
            {{end}}
        </tbody>
    </table>
</div>
{{end}}
